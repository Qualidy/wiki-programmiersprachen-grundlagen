# XML Grundlagen 1 – Syntax, Struktur & Validierung

!!! abstract "Lernziele"
    Nach diesem Kapitel kannst du …

    - Die **grundlegende XML-Syntax** korrekt anwenden.
    - **XML-Dokumente** mit Elementen, Attributen und Werten erstellen.
    - Unterschiede zwischen **XML und HTML** verstehen.
    - **Well-formed XML** (wohlgeformtes XML) erkennen und erstellen.
    - **XML-Validierung** mit DTDs und Schemas verstehen.

---

## Einführung

XML (e**X**tensible **M**arkup **L**anguage) ist eine **Markup-Sprache** zur Strukturierung von Daten. Im Gegensatz zu HTML, das für die Darstellung entwickelt wurde, dient XML zur **Datenrepräsentation**.

![XML Logo](https://upload.wikimedia.org/wikipedia/commons/thumb/6/63/XML_logo.svg/300px-XML_logo.svg.png){ align=left width=300px }

**Wichtige Fakten:**
- XML wurde 1998 vom W3C standardisiert
- XML ist **erweiterbar** (jeder kann eigene Tags definieren)
- XML ist **plattformunabhängig** und textbasiert
- XML wird für Konfigurationsdateien, Daten austausch und Web Services verwendet

**Anwendungsbereiche:**
- Konfigurationsdateien (z. B. `pom.xml` in Maven)
- Daten austausch zwischen Systemen (SOAP, REST)
- Dokumentenformat (DOCX, SVG)
- RSS-Feeds

---

## XML vs. HTML

| Aspekt | HTML | XML |
|--------|------|-----|
| **Zweck** | Darstellung von Webseiten | Strukturierung von Daten |
| **Tags** | Vorgegeben (h1, p, div, ...) | Beliebig (selbst definiert) |
| **Fehler** | Browser sind tolerant | Strikt (muss wohlgeformt sein) |
| **Groß-/Kleinschreibung** | Nicht wichtig | Wichtig (case-sensitive) |
| **Leerzeichen** | Ignoriert | Wichtig (werden erhalten) |
| **Kommentare** | `<!-- -->` | `<!-- -->` (gleich) |

---

## XML-Syntax-Regeln

### 1. Wurzelelement
Jedes XML-Dokument muss **genau ein Wurzelelement** haben:

```xml
<?xml version="1.0" encoding="UTF-8"?>
<root>
  <!-- Inhalt -->
</root>
```

### 2. Tags müssen geschlossen werden
```xml
<!-- ✅ Korrekt -->
<persönliche-daten>
  <name>Max Mustermann</name>
  <alter>25</alter>
</persönliche-daten>

<!-- ❌ Falsch -->
<persönliche-daten>
  <name>Max Mustermann
  <alter>25</alter>
</persönliche-daten>
```

### 3. Groß-/Kleinschreibung beachten
```xml
<!-- ✅ Korrekt -->
<person>
  <name>Max</name>
</person>

<!-- ❌ Falsch (öffnendes und schließendes Tag unterschiedlich) -->
<person>
  <name>Max</NAME>
</person>
```

### 4. Attribute in Anführungszeichen
```xml
<!-- ✅ Korrekt -->
<person id="1" status="aktiv">
  <name>Max</name>
</person>

<!-- ❌ Falsch -->
<person id=1 status=aktiv>
  <name>Max</name>
</person>
```

### 5. Verschachtelung (Nesting)
```xml
<!-- ✅ Korrekt -->
<adresse>
  <strasse>Hauptstraße 1</strasse>
  <stadt>
    <name>Berlin</name>
    <plz>10115</plz>
  </stadt>
</adresse>

<!-- ❌ Falsch (über Kreuz) -->
<adresse>
  <strasse>Hauptstraße 1</stadt>
  <stadt>Berlin</strasse>
</adresse>
```

### 6. Kommentare
```xml
<!-- Dies ist ein Kommentar -->
<person>
  <name>Max</name>
</person>
```

### 7. CDATA-Sektionen (für Sonderzeichen)
```xml
<script>
  <![CDATA[
    if (x < 5 && y > 3) {
      console.log("Test");
    }
  ]]>
</script>
```

---

## XML-Dokument-Struktur

### Deklaration
Die erste Zeile ist optional, aber empfohlen:

```xml
<?xml version="1.0" encoding="UTF-8"?>
```

- `version="1.0"` - XML-Version (1.0 oder 1.1)
- `encoding="UTF-8"` - Zeichencodierung (UTF-8 ist Standard)

### Elemente
```xml
<element>Textinhalt</element>
```

### Attribute
```xml
<element attribut="wert">Text</element>
```

### Text
```xml
<element>Textinhalt mit <emph>Formatierung</emph></element>
```

---

## Praktische Beispiele

### Beispiel 1: Einfaches Adressbuch
```xml
<?xml version="1.0" encoding="UTF-8"?>
<adressbuch>
  <kontakt id="1">
    <name>Max Mustermann</name>
    <email>max@example.com</email>
    <telefon>+49 123 456789</telefon>
    <adresse>
      <strasse>Hauptstraße 1</strasse>
      <stadt>Berlin</stadt>
      <plz>10115</plz>
    </adresse>
  </kontakt>

  <kontakt id="2">
    <name>Anna Müller</name>
    <email>anna@example.com</email>
    <telefon>+49 987 654321</telefon>
    <adresse>
      <strasse>Nebenstraße 42</strasse>
      <stadt>Hamburg</stadt>
      <plz>20095</plz>
    </adresse>
  </kontakt>
</adressbuch>
```

### Beispiel 2: Konfigurationsdatei
```xml
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <database>
    <host>localhost</host>
    <port>5432</port>
    <name>myapp</name>
    <user>admin</user>
    <password encrypted="true">abc123</password>
  </database>

  <server>
    <port>8080</port>
    <ssl enabled="true">
      <certificate>/path/to/cert.pem</certificate>
      <key>/path/to/key.pem</key>
    </ssl>
  </server>

  <logging>
    <level>INFO</level>
    <file>/var/log/app.log</file>
  </logging>
</configuration>
```

### Beispiel 3: Produktliste
```xml
<?xml version="1.0" encoding="UTF-8"?>
<produktliste>
  <produkt id="1001" kategorie="elektronik">
    <name>Laptop</name>
    <preis waehrung="EUR">1299.99</preis>
    <lagerbestand>15</lagerbestand>
    <beschreibung>
      Hochleistungs-Laptop mit 15-Zoll-Display
    </beschreibung>
  </produkt>

  <produkt id="1002" kategorie="elektronik">
    <name>Smartphone</name>
    <preis waehrung="EUR">699.99</preis>
    <lagerbestand>42</lagerbestand>
    <beschreibung>
      Modernes Smartphone mit Triple-Kamera
    </beschreibung>
  </produkt>
</produktliste>
```

{{ task(file="tasks/03_00_01.yaml") }}

---

## Attribute vs. Elemente

### Wann Attribute verwenden?
- **Metadaten** (zusätzliche Informationen über das Element)
- **Eindeutige Identifikatoren** (id, key)
- **Kleine, einfache Werte**

```xml
<person id="123" status="aktiv">
  <name>Max</name>
</person>
```

### Wann Elemente verwenden?
- **Strukturierte Daten** (mehrere Werte)
- **Wiederholbare Daten** (Listen)
- **Komplexe Informationen**

```xml
<adresse>
  <strasse>Hauptstraße 1</strasse>
  <stadt>Berlin</stadt>
  <plz>10115</plz>
</adresse>
```

### Kombination
```xml
<produkt id="1001" kategorie="elektronik">
  <name>Laptop</name>
  <preis waehrung="EUR">1299.99</preis>
</produkt>
```

---

## Well-formed XML

Ein XML-Dokument ist **well-formed** (wohlgeformt), wenn es alle Syntax-Regeln erfüllt:

### Checkliste für Well-formed XML
- [ ] Genau ein Wurzelelement
- [ ] Alle Tags geschlossen
- [ ] Groß-/Kleinschreibung beachtet
- [ ] Attribute in Anführungszeichen
- [ ] Korrekte Verschachtelung
- [ ] Keine reservierten Zeichen ohne Escaping
- [ ] Gültige Zeichencodierung

### Beispiel: Well-formed vs. Not well-formed
```xml
<!-- ✅ Well-formed -->
<root>
  <element>Text</element>
</root>

<!-- ❌ Not well-formed (fehlendes schließendes Tag) -->
<root>
  <element>Text
</root>

<!-- ❌ Not well-formed (falsche Verschachtelung) -->
<root>
  <element1>Text</element2>
</root>
```

---

## XML-Validierung

Well-formed ist nur der erste Schritt. **Validierung** prüft, ob das Dokument einer bestimmten Struktur entspricht.

### DTD (Document Type Definition)
Eine DTD definiert die erlaubte Struktur:

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE adressbuch [
  <!ELEMENT adressbuch (kontakt+)>
  <!ELEMENT kontakt (name, email, telefon, adresse)>
  <!ELEMENT name (#PCDATA)>
  <!ELEMENT email (#PCDATA)>
  <!ELEMENT telefon (#PCDATA)>
  <!ELEMENT adresse (strasse, stadt, plz)>
  <!ELEMENT strasse (#PCDATA)>
  <!ELEMENT stadt (#PCDATA)>
  <!ELEMENT plz (#PCDATA)>
  <!ATTLIST kontakt id CDATA #REQUIRED>
]>

<adressbuch>
  <kontakt id="1">
    <name>Max Mustermann</name>
    <email>max@example.com</email>
    <telefon>+49 123 456789</telefon>
    <adresse>
      <strasse>Hauptstraße 1</strasse>
      <stadt>Berlin</stadt>
      <plz>10115</plz>
    </adresse>
  </kontakt>
</adressbuch>
```

### XML Schema (XSD)
XML Schema ist moderner und mächtiger als DTD:

```xml
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="adressbuch">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="kontakt" maxOccurs="unbounded">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="name" type="xs:string"/>
              <xs:element name="email" type="xs:string"/>
              <xs:element name="telefon" type="xs:string"/>
              <xs:element name="adresse">
                <xs:complexType>
                  <xs:sequence>
                    <xs:element name="strasse" type="xs:string"/>
                    <xs:element name="stadt" type="xs:string"/>
                    <xs:element name="plz" type="xs:string"/>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
            <xs:attribute name="id" type="xs:string" use="required"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema>
```

---

## XML-Namespaces

Namespaces vermeiden Namenskonflikte bei XML-Dokumenten:

```xml
<?xml version="1.0" encoding="UTF-8"?>
<root xmlns:html="http://www.w3.org/1999/xhtml"
      xmlns:svg="http://www.w3.org/2000/svg">

  <html:h1>Überschrift</html:h1>
  <svg:svg width="100" height="100">
    <svg:circle cx="50" cy="50" r="40"/>
  </svg:svg>
</root>
```

---

## Häufige Fehler & Best Practices

### Fehler 1: Fehlendes Wurzelelement
```xml
<!-- ❌ Falsch -->
<person>Max</person>
<person>Anna</person>

<!-- ✅ Gut -->
<adressbuch>
  <person>Max</person>
  <person>Anna</person>
</adressbuch>
```

### Fehler 2: Ungültige Zeichen in Attributen
```xml
<!-- ❌ Falsch -->
<person name="Max Müller">

<!-- ✅ Gut (mit Escaping) -->
<person name="Max Müller">
```

### Fehler 3: Vergessene Anführungszeichen
```xml
<!-- ❌ Falsch -->
<person id=1>

<!-- ✅ Gut -->
<person id="1">
```

### Best Practices
1. **UTF-8** als Zeichencodierung verwenden
2. **Sprechende Elementnamen** (z. B. `<adresse>` statt `<adr>`)
3. **Konsistente Einrückung** (2 oder 4 Leerzeichen)
4. **Attribute für Metadaten**, Elemente für Daten
5. **Dokumentation** mit Kommentaren
6. **Validierung** mit DTD oder Schema

---

## Zusammenfassung & Checkliste

### Wichtige Konzepte
- ✅ **XML-Syntax**: Ein Wurzelelement, geschlossene Tags, Attribute in Anführungszeichen
- ✅ **Well-formed**: Alle Syntax-Regeln erfüllt
- ✅ **Attribute vs. Elemente**: Wann welches verwenden?
- ✅ **Validierung**: DTD und XML Schema
- ✅ **Namespaces**: Namenskonflikte vermeiden

### Checkliste für XML-Dokumente
- [ ] Ein Wurzelelement
- [ ] Alle Tags geschlossen
- [ ] Groß-/Kleinschreibung beachtet
- [ ] Attribute in Anführungszeichen
- [ ] Korrekte Verschachtelung
- [ ] UTF-8 Zeichencodierung
- [ ] Validierung (optional)

---

## Nächste Schritte

Nachdem du diese Grundlagen beherrschst:
1. **DTD** - Dokumenttyp-Definitionen erstellen
2. **XML Schema (XSD)** - Komplexe Strukturen definieren
3. **XPath** - XML-Daten abfragen
4. **XSLT** - XML transformieren
5. **XML-Parsing** - XML in Anwendungen verarbeiten

**Empfohlene Ressourcen:**
- [MDN Web Docs - XML](https://developer.mozilla.org/de/docs/Web/XML)
- [W3Schools XML Tutorial](https://www.w3schools.com/xml/)
- [XML.com](https://www.xml.com/)
