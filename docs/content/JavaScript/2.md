# JavaScript Grundlagen 2 – Kontrollstrukturen & Funktionen

!!! abstract "Lernziele"
    Nach diesem Kapitel kannst du …

    - **Kontrollstrukturen** (if/else, switch) für Entscheidungen nutzen.
    - **Schleifen** (for, while, do-while) für Wiederholungen verwenden.
    - **Funktionen** deklarieren und aufrufen.
    - **Parameter** und **Rückgabewerte** verstehen.
    - **Scope** (Block-Scope vs. Function-Scope) erkennen.

---

## Einführung

Kontrollstrukturen und Funktionen sind die **Bausteine jeder Programmierung**. Sie ermöglichen logische Entscheidungen und wiederverwendbare Code-Blöcke.

**Wichtige Fakten:**
- **Kontrollstrukturen** steuern den Programmfluss
- **Funktionen** organisieren Code in wiederverwendbare Einheiten
- **Scope** bestimmt, wo Variablen sichtbar sind
- **Arrow Functions** (ES6) bieten eine kurze Syntax

---

## Kontrollstrukturen

### if / else if / else

```javascript
const alter = 18;

if (alter >= 18) {
  console.log("Volljährig");
} else if (alter >= 16) {
  console.log("Teilweise volljährig");
} else {
  console.log("Minderjährig");
}
```

### Logische Operatoren in Bedingungen

```javascript
const istAdmin = true;
const istAktiv = false;
const alter = 25;

// AND (beide müssen true sein)
if (istAdmin && istAktiv && alter >= 18) {
  console.log("Zugriff erlaubt");
}

// OR (einer muss true sein)
if (istAdmin || istAktiv) {
  console.log("Mindestens eine Bedingung erfüllt");
}

// NOT (umkehren)
if (!istAdmin) {
  console.log("Kein Admin");
}
```

### Switch-Statement

```javascript
const tag = "Montag";

switch (tag) {
  case "Montag":
    console.log("Wochenstart");
    break;
  case "Freitag":
    console.log("Wochenende naht");
    break;
  case "Samstag":
  case "Sonntag":
    console.log("Wochenende!");
    break;
  default:
    console.log("Normaler Arbeitstag");
}
```

### Ternary Operator (Kurzform)

```javascript
const alter = 20;
const status = alter >= 18 ? "Volljährig" : "Minderjährig";
console.log(status); // "Volljährig"
```

{{ task(file="tasks/02_00_06.yaml") }}

---

## Schleifen

### For-Schleife

```javascript
// Zählen von 1 bis 10
for (let i = 1; i <= 10; i++) {
  console.log(i);
}

// Array durchlaufen
const farben = ["Rot", "Grün", "Blau"];
for (let i = 0; i < farben.length; i++) {
  console.log(farben[i]);
}

// For-of (ES6) - für Arrays
for (const farbe of farben) {
  console.log(farbe);
}
```

### While-Schleife

```javascript
let counter = 0;

while (counter < 5) {
  console.log(counter);
  counter++;
}

// Do-While (läuft mindestens einmal)
let x = 10;
do {
  console.log(x);
  x--;
} while (x > 0);
```

### Break und Continue

```javascript
// Break: Schleife vorzeitig beenden
for (let i = 0; i < 10; i++) {
  if (i === 5) {
    break; // Stoppt bei 5
  }
  console.log(i);
}

// Continue: Überspringt aktuelle Iteration
for (let i = 0; i < 10; i++) {
  if (i % 2 === 0) {
    continue; // Überspringt gerade Zahlen
  }
  console.log(i); // Nur ungerade Zahlen
}
```

---

## Funktionen

### Deklaration

```javascript
// Function Declaration
function gruss(name) {
  return `Hallo, ${name}!`;
}

console.log(gruss("Max")); // "Hallo, Max!"
```

### Expression (Anonymous Function)

```javascript
// Function Expression
const gruss = function(name) {
  return `Hallo, ${name}!`;
};

console.log(gruss("Anna"));
```

### Arrow Functions (ES6)

```javascript
// Kurze Syntax
const gruss = (name) => `Hallo, ${name}!`;

// Ohne Parameter
const hallo = () => "Hallo Welt!";

// Mehrere Parameter
const addiere = (a, b) => a + b;

// Mit Block (mehrere Anweisungen)
const berechne = (a, b) => {
  const summe = a + b;
  return summe;
};
```

### Parameter & Rückgabewerte

```javascript
// Standardparameter (ES6)
function begruesse(name = "Gast") {
  return `Hallo, ${name}!`;
}

console.log(begruesse()); // "Hallo, Gast!"
console.log(begruesse("Max")); // "Hallo, Max!"

// Rest Parameter (ES6) - unbestimmte Anzahl
function summe(...zahlen) {
  return zahlen.reduce((a, b) => a + b, 0);
}

console.log(summe(1, 2, 3, 4)); // 10

// Rückgabewert
function quadrat(x) {
  return x * x;
}

const ergebnis = quadrat(5); // 25
```

### Callback-Funktionen

```javascript
// Funktion als Parameter
function verarbeiteDaten(daten, callback) {
  // Verarbeitung...
  const ergebnis = daten.map(x => x * 2);
  callback(ergebnis);
}

verarbeiteDaten([1, 2, 3], (result) => {
  console.log(result); // [2, 4, 6]
});
```

---

## Scope (Sichtbarkeitsbereich)

### Block-Scope (let, const)

```javascript
{
  const x = 10;
  let y = 20;
  console.log(x, y); // 10, 20
}
// console.log(x); // FEHLER: x nicht definiert
// console.log(y); // FEHLER: y nicht definiert
```

### Function-Scope (var)

```javascript
function test() {
  var x = 10; // Function-Scope
  if (true) {
    var x = 20; // Gleiche Variable!
    console.log(x); // 20
  }
  console.log(x); // 20 (nicht 10!)
}
```

### Globales Scope

```javascript
// Im Browser: globale Variable
var globale = "Ich bin global";

function zeigeGlobale() {
  console.log(globale); // Zugriff möglich
}

zeigeGlobale();
```

### Lexical Scope (Closure)

```javascript
function erstelleZähler() {
  let count = 0;

  return function() {
    count++;
    return count;
  };
}

const zähler = erstelleZähler();
console.log(zähler()); // 1
console.log(zähler()); // 2
console.log(zähler()); // 3
```

---

## Praktische Beispiele

### Beispiel 1: Zahlentabelle
```javascript
function erstelleTabelle(bis) {
  for (let i = 1; i <= bis; i++) {
    if (i % 2 === 0) {
      console.log(`${i} ist gerade`);
    } else {
      console.log(`${i} ist ungerade`);
    }
  }
}

erstelleTabelle(5);
```

### Beispiel 2: Passwort-Prüfung
```javascript
function pruefePasswort(passwort) {
  if (passwort.length < 8) {
    return "Passwort zu kurz";
  }

  if (!/[A-Z]/.test(passwort)) {
    return "Großbuchstabe fehlt";
  }

  if (!/[0-9]/.test(passwort)) {
    return "Ziffer fehlt";
  }

  return "Passwort ist stark";
}

console.log(pruefePasswort("abc")); // "Passwort zu kurz"
console.log(pruefePasswort("Passwort123")); // "Passwort ist stark"
```

### Beispiel 3: Array-Filter Funktion
```javascript
function filterZahlen(zahlen, bedingung) {
  const ergebnis = [];

  for (const zahl of zahlen) {
    if (bedingung(zahl)) {
      ergebnis.push(zahl);
    }
  }

  return ergebnis;
}

const zahlen = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
const gerade = filterZahlen(zahlen, x => x % 2 === 0);
console.log(gerade); // [2, 4, 6, 8, 10]
```

{{ task(file="tasks/02_00_07.yaml") }}

---

## Häufige Fehler & Best Practices

### Fehler 1: Vergessene Klammern bei if/else
```javascript
// ❌ Falsch
if (x > 5)
  console.log("Ja");
  console.log("Immer ausgeführt"); // Nicht Teil des if!

// ✅ Gut
if (x > 5) {
  console.log("Ja");
  console.log("Immer ausgeführt");
}
```

### Fehler 2: Unendliche Schleife
```javascript
// ❌ Falsch (while ohne Bedingungsänderung)
while (true) {
  console.log("Endlosschleife!");
}

// ✅ Gut
let i = 0;
while (i < 5) {
  console.log(i);
  i++; // Bedingung ändert sich
}
```

### Fehler 3: Funktion ohne Rückgabewert
```javascript
// ❌ Falsch (kein return)
function quadrat(x) {
  x * x; // Nur Berechnung, kein return
}

// ✅ Gut
function quadrat(x) {
  return x * x;
}
```

### Best Practices
1. **Klammern immer verwenden** bei if/else, auch bei Einzeiler
2. **for-of für Arrays** statt for mit Index
3. **Arrow Functions** für kurze Callbacks
4. **const für Funktionen** (wenn nicht neu zugewiesen)
5. **Kleine, einzelne Aufgabe** pro Funktion
6. **Dokumentation** mit JSDoc

---

## Zusammenfassung & Checkliste

### Wichtige Konzepte
- ✅ **Kontrollstrukturen**: if/else, switch, ternary
- ✅ **Schleifen**: for, while, do-while, for-of
- ✅ **Funktionen**: Declaration, Expression, Arrow
- ✅ **Parameter**: Standardwerte, Rest Parameter
- ✅ **Scope**: Block-Scope, Function-Scope, Closure
- ✅ **Callback-Funktionen**: Funktionen als Parameter

### Checkliste für Code
- [ ] Klammern bei Kontrollstrukturen
- [ ] Break/Continue korrekt verwendet
- [ ] Funktionen haben klare Rückgabewerte
- [ ] const/let statt var verwendet
- [ ] Arrow Functions für kurze Logik
- [ ] Keine unendlichen Schleifen
- [ ] Funktionen sind kurz und fokussiert

---

## Nächste Schritte

Nachdem du diese Grundlagen beherrschst:
1. **Arrays & Objects** - Datenstrukturen verwalten
2. **DOM-Manipulation** - HTML mit JavaScript ändern
3. **Event Handling** - Benutzerinteraktionen
4. **Async Programming** - Promises, Async/Await

**Empfohlene Ressourcen:**
- [MDN Web Docs - JavaScript Functions](https://developer.mozilla.org/de/docs/Web/JavaScript/Guide/Functions)
- [JavaScript.info - Kontrollstrukturen](https://javascript.info/ifelse)
- [freeCodeCamp - JavaScript Algorithms](https://www.freecodecamp.org/learn/javascript-algorithms-and-data-structures/)
